name: Deploy to GitHub Pages

on:
 push:
   branches: [main]

permissions:
 contents: write

jobs:
 deploy:
   runs-on: ubuntu-latest
   steps:
     - uses: actions/checkout@v2
     
     - name: Inject token
       run: |
         echo "Before sed:"
         grep -A 1 "window.GITHUB_CONFIG" chat.html
         
         sed -i "s|TOKEN_PLACEHOLDER|${{ secrets.FMC_GITHUB_TOKEN }}|g" chat.html
         
         echo "After sed:"
         grep -A 1 "window.GITHUB_CONFIG" chat.html
         
         echo "Full content:"
         cat chat.html
         
     - name: Deploy
       uses: peaceiris/actions-gh-pages@v3
       with:
         github_token: ${{ secrets.GITHUB_TOKEN }}
         publish_dir: .
